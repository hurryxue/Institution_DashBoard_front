import React, {useEffect, useState} from 'react';
import BokehPlot from "./BokehPlot";

import DataTable from 'datatables.net-dt';

let table = new DataTable('#myTable');

// let static_plot_data = {"target_id": "member_dashboard", "root_id": "p1005", "doc": {"version": "3.3.4", "title": "", "roots": [{"type": "object", "name": "Figure", "id": "p1005", "attributes": {"x_range": {"type": "object", "name": "FactorRange", "id": "p1004", "attributes": {"factors": ["astro-ph", "cond-mat", "cs"], "range_padding": 0.1}}, "y_range": {"type": "object", "name": "DataRange1d", "id": "p1007", "attributes": {"start": 0}}, "x_scale": {"type": "object", "name": "CategoricalScale", "id": "p1015"}, "y_scale": {"type": "object", "name": "LinearScale", "id": "p1016"}, "title": {"type": "object", "name": "Title", "id": "p1008", "attributes": {"text": "Article Count by Year and Archive"}}, "renderers": [{"type": "object", "name": "GlyphRenderer", "id": "p1039", "attributes": {"name": "2021", "data_source": {"type": "object", "name": "ColumnDataSource", "id": "p1001", "attributes": {"selected": {"type": "object", "name": "Selection", "id": "p1002", "attributes": {"indices": [], "line_indices": []}}, "selection_policy": {"type": "object", "name": "UnionRenderers", "id": "p1003"}, "data": {"type": "map", "entries": [["archives", ["astro-ph", "cond-mat", "cs"]], ["2021", [688, 181, 857]], ["2022", [659, 225, 960]], ["2023", [853, 210, 958]]]}}}, "view": {"type": "object", "name": "CDSView", "id": "p1040", "attributes": {"filter": {"type": "object", "name": "AllIndices", "id": "p1041"}}}, "glyph": {"type": "object", "name": "VBar", "id": "p1036", "attributes": {"x": {"type": "field", "field": "archives"}, "width": {"type": "value", "value": 0.9}, "bottom": {"type": "expr", "expr": {"type": "object", "name": "Stack", "id": "p1027", "attributes": {"fields": []}}}, "top": {"type": "expr", "expr": {"type": "object", "name": "Stack", "id": "p1028", "attributes": {"fields": ["2021"]}}}, "line_color": {"type": "value", "value": "#c9d9d3"}, "fill_color": {"type": "value", "value": "#c9d9d3"}, "hatch_color": {"type": "value", "value": "#c9d9d3"}}}, "nonselection_glyph": {"type": "object", "name": "VBar", "id": "p1037", "attributes": {"x": {"type": "field", "field": "archives"}, "width": {"type": "value", "value": 0.9}, "bottom": {"type": "expr", "expr": {"id": "p1027"}}, "top": {"type": "expr", "expr": {"id": "p1028"}}, "line_color": {"type": "value", "value": "#c9d9d3"}, "line_alpha": {"type": "value", "value": 0.1}, "fill_color": {"type": "value", "value": "#c9d9d3"}, "fill_alpha": {"type": "value", "value": 0.1}, "hatch_color": {"type": "value", "value": "#c9d9d3"}, "hatch_alpha": {"type": "value", "value": 0.1}}}, "muted_glyph": {"type": "object", "name": "VBar", "id": "p1038", "attributes": {"x": {"type": "field", "field": "archives"}, "width": {"type": "value", "value": 0.9}, "bottom": {"type": "expr", "expr": {"id": "p1027"}}, "top": {"type": "expr", "expr": {"id": "p1028"}}, "line_color": {"type": "value", "value": "#c9d9d3"}, "line_alpha": {"type": "value", "value": 0.2}, "fill_color": {"type": "value", "value": "#c9d9d3"}, "fill_alpha": {"type": "value", "value": 0.2}, "hatch_color": {"type": "value", "value": "#c9d9d3"}, "hatch_alpha": {"type": "value", "value": 0.2}}}}}, {"type": "object", "name": "GlyphRenderer", "id": "p1050", "attributes": {"name": "2022", "data_source": {"id": "p1001"}, "view": {"type": "object", "name": "CDSView", "id": "p1051", "attributes": {"filter": {"type": "object", "name": "AllIndices", "id": "p1052"}}}, "glyph": {"type": "object", "name": "VBar", "id": "p1047", "attributes": {"x": {"type": "field", "field": "archives"}, "width": {"type": "value", "value": 0.9}, "bottom": {"type": "expr", "expr": {"type": "object", "name": "Stack", "id": "p1029", "attributes": {"fields": ["2021"]}}}, "top": {"type": "expr", "expr": {"type": "object", "name": "Stack", "id": "p1030", "attributes": {"fields": ["2021", "2022"]}}}, "line_color": {"type": "value", "value": "#718dbf"}, "fill_color": {"type": "value", "value": "#718dbf"}, "hatch_color": {"type": "value", "value": "#718dbf"}}}, "nonselection_glyph": {"type": "object", "name": "VBar", "id": "p1048", "attributes": {"x": {"type": "field", "field": "archives"}, "width": {"type": "value", "value": 0.9}, "bottom": {"type": "expr", "expr": {"id": "p1029"}}, "top": {"type": "expr", "expr": {"id": "p1030"}}, "line_color": {"type": "value", "value": "#718dbf"}, "line_alpha": {"type": "value", "value": 0.1}, "fill_color": {"type": "value", "value": "#718dbf"}, "fill_alpha": {"type": "value", "value": 0.1}, "hatch_color": {"type": "value", "value": "#718dbf"}, "hatch_alpha": {"type": "value", "value": 0.1}}}, "muted_glyph": {"type": "object", "name": "VBar", "id": "p1049", "attributes": {"x": {"type": "field", "field": "archives"}, "width": {"type": "value", "value": 0.9}, "bottom": {"type": "expr", "expr": {"id": "p1029"}}, "top": {"type": "expr", "expr": {"id": "p1030"}}, "line_color": {"type": "value", "value": "#718dbf"}, "line_alpha": {"type": "value", "value": 0.2}, "fill_color": {"type": "value", "value": "#718dbf"}, "fill_alpha": {"type": "value", "value": 0.2}, "hatch_color": {"type": "value", "value": "#718dbf"}, "hatch_alpha": {"type": "value", "value": 0.2}}}}}, {"type": "object", "name": "GlyphRenderer", "id": "p1060", "attributes": {"name": "2023", "data_source": {"id": "p1001"}, "view": {"type": "object", "name": "CDSView", "id": "p1061", "attributes": {"filter": {"type": "object", "name": "AllIndices", "id": "p1062"}}}, "glyph": {"type": "object", "name": "VBar", "id": "p1057", "attributes": {"x": {"type": "field", "field": "archives"}, "width": {"type": "value", "value": 0.9}, "bottom": {"type": "expr", "expr": {"type": "object", "name": "Stack", "id": "p1031", "attributes": {"fields": ["2021", "2022"]}}}, "top": {"type": "expr", "expr": {"type": "object", "name": "Stack", "id": "p1032", "attributes": {"fields": ["2021", "2022", "2023"]}}}, "line_color": {"type": "value", "value": "#e84d60"}, "fill_color": {"type": "value", "value": "#e84d60"}, "hatch_color": {"type": "value", "value": "#e84d60"}}}, "nonselection_glyph": {"type": "object", "name": "VBar", "id": "p1058", "attributes": {"x": {"type": "field", "field": "archives"}, "width": {"type": "value", "value": 0.9}, "bottom": {"type": "expr", "expr": {"id": "p1031"}}, "top": {"type": "expr", "expr": {"id": "p1032"}}, "line_color": {"type": "value", "value": "#e84d60"}, "line_alpha": {"type": "value", "value": 0.1}, "fill_color": {"type": "value", "value": "#e84d60"}, "fill_alpha": {"type": "value", "value": 0.1}, "hatch_color": {"type": "value", "value": "#e84d60"}, "hatch_alpha": {"type": "value", "value": 0.1}}}, "muted_glyph": {"type": "object", "name": "VBar", "id": "p1059", "attributes": {"x": {"type": "field", "field": "archives"}, "width": {"type": "value", "value": 0.9}, "bottom": {"type": "expr", "expr": {"id": "p1031"}}, "top": {"type": "expr", "expr": {"id": "p1032"}}, "line_color": {"type": "value", "value": "#e84d60"}, "line_alpha": {"type": "value", "value": 0.2}, "fill_color": {"type": "value", "value": "#e84d60"}, "fill_alpha": {"type": "value", "value": 0.2}, "hatch_color": {"type": "value", "value": "#e84d60"}, "hatch_alpha": {"type": "value", "value": 0.2}}}}}], "toolbar": {"type": "object", "name": "Toolbar", "id": "p1014"}, "toolbar_location": null, "left": [{"type": "object", "name": "LinearAxis", "id": "p1022", "attributes": {"ticker": {"type": "object", "name": "BasicTicker", "id": "p1023", "attributes": {"mantissas": [1, 2, 5]}}, "formatter": {"type": "object", "name": "BasicTickFormatter", "id": "p1024"}, "major_label_policy": {"type": "object", "name": "AllLabels", "id": "p1025"}}}], "below": [{"type": "object", "name": "CategoricalAxis", "id": "p1017", "attributes": {"ticker": {"type": "object", "name": "CategoricalTicker", "id": "p1018"}, "formatter": {"type": "object", "name": "CategoricalTickFormatter", "id": "p1019"}, "major_label_orientation": 1, "major_label_policy": {"type": "object", "name": "AllLabels", "id": "p1020"}}}], "center": [{"type": "object", "name": "Grid", "id": "p1021", "attributes": {"axis": {"id": "p1017"}, "grid_line_color": null}}, {"type": "object", "name": "Grid", "id": "p1026", "attributes": {"dimension": 1, "axis": {"id": "p1022"}}}, {"type": "object", "name": "Legend", "id": "p1042", "attributes": {"location": "top_left", "orientation": "horizontal", "items": [{"type": "object", "name": "LegendItem", "id": "p1043", "attributes": {"label": {"type": "value", "value": "2021"}, "renderers": [{"id": "p1039"}]}}, {"type": "object", "name": "LegendItem", "id": "p1053", "attributes": {"label": {"type": "value", "value": "2022"}, "renderers": [{"id": "p1050"}]}}, {"type": "object", "name": "LegendItem", "id": "p1063", "attributes": {"label": {"type": "value", "value": "2023"}, "renderers": [{"id": "p1060"}]}}]}}]}}]}, "version": "3.3.4"}

// let test_plot_data = {"target_id": "member_dashboard", "root_id": "p1705", "doc": {"version": "3.4.0", "title": "", "roots": [{"type": "object", "name": "Figure", "id": "p1705", "attributes": {"x_range": {"type": "object", "name": "DataRange1d", "id": "p1706"}, "y_range": {"type": "object", "name": "DataRange1d", "id": "p1707"}, "x_scale": {"type": "object", "name": "LinearScale", "id": "p1715"}, "y_scale": {"type": "object", "name": "LinearScale", "id": "p1716"}, "title": {"type": "object", "name": "Title", "id": "p1708", "attributes": {"text": "Simple Line Example"}}, "renderers": [{"type": "object", "name": "GlyphRenderer", "id": "p1744", "attributes": {"data_source": {"type": "object", "name": "ColumnDataSource", "id": "p1738", "attributes": {"selected": {"type": "object", "name": "Selection", "id": "p1739", "attributes": {"indices": [], "line_indices": []}}, "selection_policy": {"type": "object", "name": "UnionRenderers", "id": "p1740"}, "data": {"type": "map", "entries": [["x", [1, 2, 3, 4, 5]], ["y", [6, 7, 2, 4, 5]]]}}}, "view": {"type": "object", "name": "CDSView", "id": "p1745", "attributes": {"filter": {"type": "object", "name": "AllIndices", "id": "p1746"}}}, "glyph": {"type": "object", "name": "Line", "id": "p1741", "attributes": {"x": {"type": "field", "field": "x"}, "y": {"type": "field", "field": "y"}, "line_color": "#1f77b4", "line_width": 2}}, "nonselection_glyph": {"type": "object", "name": "Line", "id": "p1742", "attributes": {"x": {"type": "field", "field": "x"}, "y": {"type": "field", "field": "y"}, "line_color": "#1f77b4", "line_alpha": 0.1, "line_width": 2}}, "muted_glyph": {"type": "object", "name": "Line", "id": "p1743", "attributes": {"x": {"type": "field", "field": "x"}, "y": {"type": "field", "field": "y"}, "line_color": "#1f77b4", "line_alpha": 0.2, "line_width": 2}}}}], "toolbar": {"type": "object", "name": "Toolbar", "id": "p1714", "attributes": {"tools": [{"type": "object", "name": "PanTool", "id": "p1727"}, {"type": "object", "name": "WheelZoomTool", "id": "p1728", "attributes": {"renderers": "auto"}}, {"type": "object", "name": "BoxZoomTool", "id": "p1729", "attributes": {"overlay": {"type": "object", "name": "BoxAnnotation", "id": "p1730", "attributes": {"syncable": false, "level": "overlay", "visible": false, "left": {"type": "number", "value": "nan"}, "right": {"type": "number", "value": "nan"}, "top": {"type": "number", "value": "nan"}, "bottom": {"type": "number", "value": "nan"}, "left_units": "canvas", "right_units": "canvas", "top_units": "canvas", "bottom_units": "canvas", "line_color": "black", "line_alpha": 1.0, "line_width": 2, "line_dash": [4, 4], "fill_color": "lightgrey", "fill_alpha": 0.5}}}}, {"type": "object", "name": "SaveTool", "id": "p1735"}, {"type": "object", "name": "ResetTool", "id": "p1736"}, {"type": "object", "name": "HelpTool", "id": "p1737"}]}}, "left": [{"type": "object", "name": "LinearAxis", "id": "p1722", "attributes": {"ticker": {"type": "object", "name": "BasicTicker", "id": "p1723", "attributes": {"mantissas": [1, 2, 5]}}, "formatter": {"type": "object", "name": "BasicTickFormatter", "id": "p1724"}, "axis_label": "y", "major_label_policy": {"type": "object", "name": "AllLabels", "id": "p1725"}}}], "below": [{"type": "object", "name": "LinearAxis", "id": "p1717", "attributes": {"ticker": {"type": "object", "name": "BasicTicker", "id": "p1718", "attributes": {"mantissas": [1, 2, 5]}}, "formatter": {"type": "object", "name": "BasicTickFormatter", "id": "p1719"}, "axis_label": "x", "major_label_policy": {"type": "object", "name": "AllLabels", "id": "p1720"}}}], "center": [{"type": "object", "name": "Grid", "id": "p1721", "attributes": {"axis": {"id": "p1717"}}}, {"type": "object", "name": "Grid", "id": "p1726", "attributes": {"dimension": 1, "axis": {"id": "p1722"}}}, {"type": "object", "name": "Legend", "id": "p1747", "attributes": {"items": [{"type": "object", "name": "LegendItem", "id": "p1748", "attributes": {"label": {"type": "value", "value": "Temp."}, "renderers": [{"id": "p1744"}]}}]}}]}}]}, "version": "3.4.0"}

// let bar_plot_data = {"target_id": "member_dashboard", "root_id": "p1001", "doc": {"version": "3.4.0", "title": "", "roots": [{"type": "object", "name": "Figure", "id": "p1001", "attributes": {"height": 350, "x_range": {"type": "object", "name": "FactorRange", "id": "p1011", "attributes": {"factors": ["A", "B", "C", "D"]}}, "y_range": {"type": "object", "name": "DataRange1d", "id": "p1003"}, "x_scale": {"type": "object", "name": "CategoricalScale", "id": "p1012"}, "y_scale": {"type": "object", "name": "LinearScale", "id": "p1013"}, "title": {"type": "object", "name": "Title", "id": "p1004", "attributes": {"text": "Bar Graph Example"}}, "renderers": [{"type": "object", "name": "GlyphRenderer", "id": "p1030", "attributes": {"data_source": {"type": "object", "name": "ColumnDataSource", "id": "p1024", "attributes": {"selected": {"type": "object", "name": "Selection", "id": "p1025", "attributes": {"indices": [], "line_indices": []}}, "selection_policy": {"type": "object", "name": "UnionRenderers", "id": "p1026"}, "data": {"type": "map", "entries": [["x", ["A", "B", "C", "D"]], ["top", [4, 7, 5, 3]]]}}}, "view": {"type": "object", "name": "CDSView", "id": "p1031", "attributes": {"filter": {"type": "object", "name": "AllIndices", "id": "p1032"}}}, "glyph": {"type": "object", "name": "VBar", "id": "p1027", "attributes": {"x": {"type": "field", "field": "x"}, "width": {"type": "value", "value": 0.9}, "top": {"type": "field", "field": "top"}, "line_color": {"type": "value", "value": "#1f77b4"}, "fill_color": {"type": "value", "value": "#1f77b4"}}}, "nonselection_glyph": {"type": "object", "name": "VBar", "id": "p1028", "attributes": {"x": {"type": "field", "field": "x"}, "width": {"type": "value", "value": 0.9}, "top": {"type": "field", "field": "top"}, "line_color": {"type": "value", "value": "#1f77b4"}, "line_alpha": {"type": "value", "value": 0.1}, "fill_color": {"type": "value", "value": "#1f77b4"}, "fill_alpha": {"type": "value", "value": 0.1}, "hatch_alpha": {"type": "value", "value": 0.1}}}, "muted_glyph": {"type": "object", "name": "VBar", "id": "p1029", "attributes": {"x": {"type": "field", "field": "x"}, "width": {"type": "value", "value": 0.9}, "top": {"type": "field", "field": "top"}, "line_color": {"type": "value", "value": "#1f77b4"}, "line_alpha": {"type": "value", "value": 0.2}, "fill_color": {"type": "value", "value": "#1f77b4"}, "fill_alpha": {"type": "value", "value": 0.2}, "hatch_alpha": {"type": "value", "value": 0.2}}}}}], "toolbar": {"type": "object", "name": "Toolbar", "id": "p1010"}, "toolbar_location": null, "left": [{"type": "object", "name": "LinearAxis", "id": "p1019", "attributes": {"ticker": {"type": "object", "name": "BasicTicker", "id": "p1020", "attributes": {"mantissas": [1, 2, 5]}}, "formatter": {"type": "object", "name": "BasicTickFormatter", "id": "p1021"}, "axis_label": "Values", "major_label_policy": {"type": "object", "name": "AllLabels", "id": "p1022"}}}], "below": [{"type": "object", "name": "CategoricalAxis", "id": "p1014", "attributes": {"ticker": {"type": "object", "name": "CategoricalTicker", "id": "p1015"}, "formatter": {"type": "object", "name": "CategoricalTickFormatter", "id": "p1016"}, "major_label_policy": {"type": "object", "name": "AllLabels", "id": "p1017"}}}], "center": [{"type": "object", "name": "Grid", "id": "p1018", "attributes": {"axis": {"id": "p1014"}}}, {"type": "object", "name": "Grid", "id": "p1023", "attributes": {"dimension": 1, "axis": {"id": "p1019"}}}]}}]}, "version": "3.4.0"}

let chris_data = {"target_id": "member_dashboard", "root_id": "p1241", "doc": {"version": "3.4.0", "title": "", "roots": [{"type": "object", "name": "Figure", "id": "p1241", "attributes": {"width": 800, "height": 1200, "x_range": {"type": "object", "name": "DataRange1d", "id": "p1243", "attributes": {"start": 0, "end": 1104.0}}, "y_range": {"type": "object", "name": "FactorRange", "id": "p1240", "attributes": {"factors": [["stat", "2023"], ["stat", "2022"], ["stat", "2021"], ["quant-ph", "2023"], ["quant-ph", "2022"], ["quant-ph", "2021"], ["q-fin", "2023"], ["q-fin", "2022"], ["q-fin", "2021"], ["q-bio", "2023"], ["q-bio", "2022"], ["q-bio", "2021"], ["physics", "2023"], ["physics", "2022"], ["physics", "2021"], ["nucl-th", "2023"], ["nucl-th", "2022"], ["nucl-th", "2021"], ["nucl-ex", "2023"], ["nucl-ex", "2022"], ["nucl-ex", "2021"], ["nlin", "2023"], ["nlin", "2022"], ["nlin", "2021"], ["math-ph", "2023"], ["math-ph", "2022"], ["math-ph", "2021"], ["math", "2023"], ["math", "2022"], ["math", "2021"], ["hep-th", "2023"], ["hep-th", "2022"], ["hep-th", "2021"], ["hep-ph", "2023"], ["hep-ph", "2022"], ["hep-ph", "2021"], ["hep-lat", "2023"], ["hep-lat", "2022"], ["hep-lat", "2021"], ["hep-ex", "2023"], ["hep-ex", "2022"], ["hep-ex", "2021"], ["gr-qc", "2023"], ["gr-qc", "2022"], ["gr-qc", "2021"], ["eess", "2023"], ["eess", "2022"], ["eess", "2021"], ["econ", "2023"], ["econ", "2022"], ["econ", "2021"], ["cs", "2023"], ["cs", "2022"], ["cs", "2021"], ["cond-mat", "2023"], ["cond-mat", "2022"], ["cond-mat", "2021"], ["astro-ph", "2023"], ["astro-ph", "2022"], ["astro-ph", "2021"]], "range_padding": 0.01}}, "x_scale": {"type": "object", "name": "LinearScale", "id": "p1251"}, "y_scale": {"type": "object", "name": "CategoricalScale", "id": "p1252"}, "title": {"type": "object", "name": "Title", "id": "p1244", "attributes": {"text": "Article count by year and archive"}}, "renderers": [{"type": "object", "name": "GlyphRenderer", "id": "p1282", "attributes": {"data_source": {"type": "object", "name": "ColumnDataSource", "id": "p1237", "attributes": {"selected": {"type": "object", "name": "Selection", "id": "p1238", "attributes": {"indices": [], "line_indices": []}}, "selection_policy": {"type": "object", "name": "UnionRenderers", "id": "p1239"}, "data": {"type": "map", "entries": [["labels", [["stat", "2023"], ["stat", "2022"], ["stat", "2021"], ["quant-ph", "2023"], ["quant-ph", "2022"], ["quant-ph", "2021"], ["q-fin", "2023"], ["q-fin", "2022"], ["q-fin", "2021"], ["q-bio", "2023"], ["q-bio", "2022"], ["q-bio", "2021"], ["physics", "2023"], ["physics", "2022"], ["physics", "2021"], ["nucl-th", "2023"], ["nucl-th", "2022"], ["nucl-th", "2021"], ["nucl-ex", "2023"], ["nucl-ex", "2022"], ["nucl-ex", "2021"], ["nlin", "2023"], ["nlin", "2022"], ["nlin", "2021"], ["math-ph", "2023"], ["math-ph", "2022"], ["math-ph", "2021"], ["math", "2023"], ["math", "2022"], ["math", "2021"], ["hep-th", "2023"], ["hep-th", "2022"], ["hep-th", "2021"], ["hep-ph", "2023"], ["hep-ph", "2022"], ["hep-ph", "2021"], ["hep-lat", "2023"], ["hep-lat", "2022"], ["hep-lat", "2021"], ["hep-ex", "2023"], ["hep-ex", "2022"], ["hep-ex", "2021"], ["gr-qc", "2023"], ["gr-qc", "2022"], ["gr-qc", "2021"], ["eess", "2023"], ["eess", "2022"], ["eess", "2021"], ["econ", "2023"], ["econ", "2022"], ["econ", "2021"], ["cs", "2023"], ["cs", "2022"], ["cs", "2021"], ["cond-mat", "2023"], ["cond-mat", "2022"], ["cond-mat", "2021"], ["astro-ph", "2023"], ["astro-ph", "2022"], ["astro-ph", "2021"]]], ["counts", [105.0, 103.0, 103.0, 103.0, 111.0, 107.0, 5.0, 2.0, 2.0, 15.0, 13.0, 9.0, 188.0, 178.0, 167.0, 12.0, 5.0, 8.0, 64.0, 78.0, 66.0, 8.0, 4.0, 1.0, 15.0, 6.0, 7.0, 215.0, 262.0, 231.0, 26.0, 34.0, 33.0, 87.0, 117.0, 74.0, 7.0, 4.0, 3.0, 110.0, 83.0, 76.0, 13.0, 13.0, 19.0, 64.0, 74.0, 92.0, 24.0, 29.0, 19.0, 958.0, 960.0, 857.0, 210.0, 225.0, 181.0, 853.0, 659.0, 688.0]]]}}}, "view": {"type": "object", "name": "CDSView", "id": "p1283", "attributes": {"filter": {"type": "object", "name": "AllIndices", "id": "p1284"}}}, "glyph": {"type": "object", "name": "HBar", "id": "p1279", "attributes": {"y": {"type": "field", "field": "labels"}, "height": {"type": "value", "value": 0.8}, "right": {"type": "field", "field": "counts"}, "line_color": {"type": "field", "field": "labels", "transform": {"type": "object", "name": "CategoricalColorMapper", "id": "p1275", "attributes": {"palette": ["#6baed6", "#3182bd", "#b31b1b"], "factors": ["2021", "2022", "2023"], "start": 1, "end": 2}}}, "fill_color": {"type": "field", "field": "labels", "transform": {"type": "object", "name": "CategoricalColorMapper", "id": "p1274", "attributes": {"palette": ["#6baed6", "#3182bd", "#b31b1b"], "factors": ["2021", "2022", "2023"], "start": 1, "end": 2}}}}}, "nonselection_glyph": {"type": "object", "name": "HBar", "id": "p1280", "attributes": {"y": {"type": "field", "field": "labels"}, "height": {"type": "value", "value": 0.8}, "right": {"type": "field", "field": "counts"}, "line_color": {"type": "field", "field": "labels", "transform": {"id": "p1275"}}, "line_alpha": {"type": "value", "value": 0.1}, "fill_color": {"type": "field", "field": "labels", "transform": {"id": "p1274"}}, "fill_alpha": {"type": "value", "value": 0.1}, "hatch_alpha": {"type": "value", "value": 0.1}}}, "muted_glyph": {"type": "object", "name": "HBar", "id": "p1281", "attributes": {"y": {"type": "field", "field": "labels"}, "height": {"type": "value", "value": 0.8}, "right": {"type": "field", "field": "counts"}, "line_color": {"type": "field", "field": "labels", "transform": {"id": "p1275"}}, "line_alpha": {"type": "value", "value": 0.2}, "fill_color": {"type": "field", "field": "labels", "transform": {"id": "p1274"}}, "fill_alpha": {"type": "value", "value": 0.2}, "hatch_alpha": {"type": "value", "value": 0.2}}}}}], "toolbar": {"type": "object", "name": "Toolbar", "id": "p1250", "attributes": {"tools": [{"type": "object", "name": "PanTool", "id": "p1263"}, {"type": "object", "name": "WheelZoomTool", "id": "p1264", "attributes": {"renderers": "auto"}}, {"type": "object", "name": "BoxZoomTool", "id": "p1265", "attributes": {"overlay": {"type": "object", "name": "BoxAnnotation", "id": "p1266", "attributes": {"syncable": false, "level": "overlay", "visible": false, "left": {"type": "number", "value": "nan"}, "right": {"type": "number", "value": "nan"}, "top": {"type": "number", "value": "nan"}, "bottom": {"type": "number", "value": "nan"}, "left_units": "canvas", "right_units": "canvas", "top_units": "canvas", "bottom_units": "canvas", "line_color": "black", "line_alpha": 1.0, "line_width": 2, "line_dash": [4, 4], "fill_color": "lightgrey", "fill_alpha": 0.5}}}}, {"type": "object", "name": "SaveTool", "id": "p1271"}, {"type": "object", "name": "ResetTool", "id": "p1272"}, {"type": "object", "name": "HelpTool", "id": "p1273"}]}}, "left": [{"type": "object", "name": "CategoricalAxis", "id": "p1258", "attributes": {"ticker": {"type": "object", "name": "CategoricalTicker", "id": "p1259"}, "formatter": {"type": "object", "name": "CategoricalTickFormatter", "id": "p1260"}, "major_label_policy": {"type": "object", "name": "AllLabels", "id": "p1261"}, "group_label_orientation": "horizontal"}}], "below": [{"type": "object", "name": "LinearAxis", "id": "p1253", "attributes": {"ticker": {"type": "object", "name": "BasicTicker", "id": "p1254", "attributes": {"mantissas": [1, 2, 5]}}, "formatter": {"type": "object", "name": "BasicTickFormatter", "id": "p1255"}, "major_label_policy": {"type": "object", "name": "AllLabels", "id": "p1256"}}}], "center": [{"type": "object", "name": "Grid", "id": "p1257", "attributes": {"axis": {"id": "p1253"}}}, {"type": "object", "name": "Grid", "id": "p1262", "attributes": {"dimension": 1, "axis": {"id": "p1258"}, "grid_line_color": null}}, {"type": "object", "name": "LabelSet", "id": "p1287", "attributes": {"level": "glyph", "source": {"id": "p1237"}, "x": {"type": "field", "field": "counts"}, "y": {"type": "field", "field": "labels"}, "text": {"type": "field", "field": "counts"}, "x_offset": {"type": "value", "value": 5}, "text_font_size": {"type": "value", "value": "11px"}, "text_baseline": {"type": "value", "value": "middle"}}}]}}]}, "version": "3.4.0"}

function App() {

    const [detail, setDetail] = useState('');
    const [institutionList, setInstitutionList] = useState([]);
    const [plotData, setPlotData] = useState(null);
    const [loadingerror,setLoadingerror] = useState(null);

    useEffect(() => {
        const fetchData = async () => {
            try {
                const response = await fetch('http://127.0.0.1:8000/getinstitutions'); // 替换为你的API URL
                const idList = await response.json();

                const institutions = []

                for (const id of idList) {
                    const response = await fetch(`http://127.0.0.1:8000/report/${id}`);
                    const results = await response.json();
                    institutions.push(results);
                }
                setInstitutionList(institutions)
                console.log(institutions);
            } catch (error) {
                console.error('Error fetching data:', error);
                setInstitutionList(null); // 在出错时设置数据为null
            }
        };

        fetchData();
    }, []); // 空数组意味着这个效果只在组件首次渲染时运行



    const handleButtonClick = async (fileId,description) => {
        setDetail(description);
        setLoadingerror(null);
        setPlotData(null)
        console.log('handleButtonClick')
        try {
            const response = await fetch(`http://127.0.0.1:8000/retrive/${fileId}`)
            const data = await response.json();
            console.log(data)
            setPlotData(data)

        }catch (error) {
            console.error('Error fetching diagram:', error);
            setLoadingerror("The file does not exist")
        }
    };

    // Style object for buttons container
    const buttonContainerStyle = {
        display: 'flex',
        flexDirection: 'column',  // Makes the buttons stack vertically
        alignItems: 'flex-start', // Aligns buttons to the left
    };

    return (
        <React.Fragment>


            <div>
                <h1>Institution Reports</h1>
                <div style={buttonContainerStyle}>

                    <table id="myTable" className="display">
                        <thead>
                        <tr>
                            <th>Column 1</th>
                        </tr>
                        </thead>
                        <tbody>
                        {institutionList.map((inst, index) => (
                            <tr>
                                <td>
                                    <button key={index}>
                                        {inst.insitution_name}
                                    </button>
                                    {/*<button key={index}*/}
                                    {/*        onClick={() => handleButtonClick(inst.institution_file_id, inst.institution_info)}>*/}
                                    {/*    {inst.insitution_name}*/}
                                    {/*</button>*/}

                                    {/*{inst.insitution_name}*/}

                                </td>
                            </tr>
                        ))}
                        </tbody>
                    </table>


                </div>
                <p>{detail}</p>
                <div>
                    <h1>Submission Report</h1>
                    {<BokehPlot data={chris_data}/>}
                    {/*{loadingerror ? (*/}
                    {/*    <p>Error loading the plot: {loadingerror}</p>*/}
                    {/*) : (*/}
                    {/*    plotData ? <BokehPlot data={test_plot_data}/> : <p>Loading...</p>*/}

                    {/*)}*/}
                </div>
            </div>
        </React.Fragment>
    )
        ;
}

export default App;
